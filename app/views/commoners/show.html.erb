<% content_for :title, @commoner.name %>
<div class="row">
  <div class="col-md-6 col-sm-12">
    <div class="row commoner-profile">
      <div class="col-sm-6">
        <%= image_tag @commoner.avatar.profile, class: 'mb-1' %>
        <p><%= @commoner.name %></p>
        <%= link_to s_('Button|Edit profile'), edit_commoner_path(@commoner), class: 'btn btn-outline-cf btn-sm' if can? :edit, @commoner %>
      </div>
    </div>
  </div>
</div>
<hr>
<div class="row">
  <div class="col">
    <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
      <li class="nav-item">
        <a class="nav-link active" id="pills-stories-tab" data-toggle="pill" href="#pills-stories" role="tab" aria-controls="pills-stories" aria-selected="true"><%= _('Stories') %></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="pills-groups-tab" data-toggle="pill" href="#pills-groups" role="tab" aria-controls="pills-groups" aria-selected="false"><%= _('Groups') %></a>
      </li>
      <% if @commoner.user == current_user %>
        <li class="nav-item">
          <a class="nav-link" id="pills-requests-tab" data-toggle="pill" href="#pills-requests" role="tab" aria-controls="pills-requests" aria-selected="false"><%= _('Requests') %></a>
        </li>
      <% end %>
      <li class="nav-item">
        <a class="nav-link" id="pills-activities-tab" data-toggle="pill" href="#pills-activities" role="tab" aria-controls="pills-activities" aria-selected="false"><%= _('Activities') %></a>
      </li>
    </ul>
    <div class="tab-content" id="pills-tabContent">
      <div class="tab-pane fade show active" id="pills-stories" role="tabpanel" aria-labelledby="pills-stories-tab">
        <% if @story_types_and_lists.any? %>
        <%= render 'stories/types_and_lists', story_types_and_lists: @story_types_and_lists %>
        <% else %>
        <div class="row justify-content-center">
          <div class="col text-center">
            <h2 class="text-muted">
              <%= _("No stories yet") %>
            </h2>
          </div>
        </div>
        <% end %>
        <% if @commoner.stories.count > 6 %>
        <div class="row justify-content-center">
          <div class="col text-center">
            <%= link_to(_('See all'), commoner_stories_path(@commoner), class: 'btn btn-outline-cf-secondary') %>
          </div>
        </div>
        <% end %>
      </div>
      <div class="tab-pane fade" id="pills-groups" role="tabpanel" aria-labelledby="pills-groups-tab">
        <%= link_to s_('Button|Start a group'), new_group_path, class: 'btn btn-outline-cf btn-block' if can? :create, Group  %>
        <% if @commoner.groups.any? %>
        <%= render @commoner.groups %>
        <% else %>
        <div class="row justify-content-center">
          <div class="col text-center">
            <h2 class="text-muted">
              <%= _("No groups") %>
            </h2>
          </div>
        </div>
        <% end %>
      </div>
      <% if @commoner.user == current_user %>
        <div class="tab-pane fade" id="pills-requests" role="tabpanel" aria-labelledby="pills-requests-tab">
          <% if @commoner.join_requests.any? %>
            <% @commoner.join_requests.each do |join_request| %>
              <p><%= link_to join_request.group.name, join_request %>, <%= join_request.aasm_state %></p>
            <% end %>
          <% else %>
          <div class="row justify-content-center">
            <div class="col text-center">
              <h2 class="text-muted">
                <%= _("No requests") %>
              </h2>
            </div>
          </div>
          <% end %>
        </div>
      <% end %>
      <div class="tab-pane fade" id="pills-activities" role="tabpanel" aria-labelledby="pills-activities-tab">
        <div class="row justify-content-center">
          <div class="col text-center">
            <h2 class="text-muted">
              <%= _("No activities yet") %>
            </h2>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
